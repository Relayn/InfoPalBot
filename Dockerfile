# 1. Базовый образ
FROM python:3.11-slim

# 2. Установка переменных окружения
# PYTHONUNBUFFERED=1 гарантирует, что вывод Python отправляется напрямую в терминал
# без буферизации, что полезно для логирования в Docker.
ENV PYTHONUNBUFFERED=1

# 3. Установка рабочей директории в контейнере
WORKDIR /app

# 4. Копирование файла с зависимостями и их установка
# Копируем только requirements.txt для кэширования этого слоя Docker.
# Этот шаг будет выполняться заново только при изменении requirements.txt.
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# 5. Копирование всего кода приложения в рабочую директорию
COPY . .

# 6. Команда для запуска приложения
# Запускаем основной модуль бота.
# API-ключи и токен бота должны быть переданы через переменные окружения
# при запуске контейнера (например, с помощью -e или --env-file).
CMD ["python", "-m", "app.bot.main"]
